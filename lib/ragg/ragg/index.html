<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>ragg: a Racket AST Generator Generator</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" pltdoc="x">ragg:<span class="mywbr"> </span> a Racket AST Generator Generator</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#(part._.Informal_quickstart)" class="tocviewlink" pltdoc="x">Informal quickstart</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#(part._.Introduction)" class="tocviewlink" pltdoc="x">Introduction</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#(part._.The_language)" class="tocviewlink" pltdoc="x">The language</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#(part._.Support_.A.P.I)" class="tocviewlink" pltdoc="x">Support API</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#(part._.Bugs_and_caveats_and_.T.O.D.Os)" class="tocviewlink" pltdoc="x">Bugs and caveats and TODOs</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#(part._.Miscellaneous_and_thanks)" class="tocviewlink" pltdoc="x">Miscellaneous and thanks</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#(part._.Informal_quickstart)" class="tocsubseclink" pltdoc="x">Informal quickstart</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#(part._.Introduction)" class="tocsubseclink" pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#(part._.The_language)" class="tocsubseclink" pltdoc="x">The language</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#(part._.Syntax_and_terminology)" class="tocsubseclink" pltdoc="x">Syntax and terminology</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#(part._.Syntax_errors)" class="tocsubseclink" pltdoc="x">Syntax errors</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#(part._.Semantics)" class="tocsubseclink" pltdoc="x">Semantics</a></td></tr><tr><td><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/examples/nested-word-list"><span class="RktSym"><span class="RktValLink">parse</span></span></span></a></td></tr><tr><td><a href="#(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/examples/nested-word-list"><span class="RktSym"><span class="RktStxLink">make-<wbr></wbr>rule-<wbr></wbr>parser</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.4<tt>&nbsp;</tt></span><a href="#(part._token-sources)" class="tocsubseclink" pltdoc="x">Token sources</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#(part._.Support_.A.P.I)" class="tocsubseclink" pltdoc="x">Support API</a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._token))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">token</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._token-struct))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">token-<wbr></wbr>struct</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> </span>fail:<span class="mywbr"> </span>parsing</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._current-source))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>source</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._current-parser-error-handler))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>parser-<wbr></wbr>error-<wbr></wbr>handler</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._ragg/support..rkt)._current-tokenizer-error-handler))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: ragg/support"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>tokenizer-<wbr></wbr>error-<wbr></wbr>handler</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#(part._.Bugs_and_caveats_and_.T.O.D.Os)" class="tocsubseclink" pltdoc="x">Bugs and caveats and TODOs</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#(part._.Miscellaneous_and_thanks)" class="tocsubseclink" pltdoc="x">Miscellaneous and thanks</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">Version: 5.3.1</span></div><h2><a name="(part._ragg__a_.Racket_.A.S.T_.Generator_.Generator)"></a>ragg: a Racket AST Generator Generator</h2><p>Danny Yoo &lt;<a href="mailto:dyoo@hashcollision.org">dyoo@hashcollision.org</a>&gt;</p><h3>1<tt>&nbsp;</tt><a name="(part._.Informal_quickstart)"></a>Informal quickstart</h3><p><div class="SIntrapara">Salutations!  Let&rsquo;s consider the following scenario: say that we&rsquo;re given the
following string:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">"(radiant (humble))"</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>(... and pretend that we don&rsquo;t already know about the built-in
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/Reading.html#(def._((quote._~23~25kernel)._read))" class="RktValLink" pltdoc="x">read</a></span> function.)</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">  How do we go about turn this kind of string into a
structured value?  That is, how would we <span style="font-style: italic">parse</span> it?</div></p><p>We need to first consider the shape of the things we&rsquo;d like to parse.  The
string above looks like a deeply nested list of words.  How might we describe
this formally?  A convenient notation to describe the shape of these things is
<a href="http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form">Backus-Naur
Form</a> (BNF).  So let&rsquo;s try to notate the structure of nested word lists in BNF.</p><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">nested-word-list: WORD</span></span></p></td></tr><tr><td><p><span class="stt"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| LEFT-PAREN nested-word-list* RIGHT-PAREN</span></span></p></td></tr></table></blockquote><p>What we intend by this notation is this: <span class="RktSym">nested-word-list</span> is either an
atomic <span class="RktSym">WORD</span>, or a parenthesized list of any number of
<span class="RktSym">nested-word-list</span>s.  We use the character <span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> to represent zero
or more repetitions of the previous thing, and we treat the uppercased
<span class="RktSym">LEFT-PAREN</span>, <span class="RktSym">RIGHT-PAREN</span>, and <span class="RktSym">WORD</span> as placeholders
for atomic <span style="font-style: italic">tokens</span>.</p><p><div class="SIntrapara">Here are a few examples of tokens:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ragg/support</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'LEFT-PAREN #f #f #f #f #f #f)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"crunchy"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:span</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'WORD "crunchy" #f #f #f 7 #f)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'RIGHT-PAREN #f #f #f #f #f #f)</span></p></td></tr></table></blockquote></div></p><p>Have we made progress?  At this point, we only have a BNF description in hand,
but we&rsquo;re still missing a <span style="font-style: italic">parser</span>, something to take that description and
use it to make structures out of a sequence of tokens.</p><p>It&rsquo;s clear that we don&rsquo;t yet have a program because there&rsquo;s no <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span>
line.  We should add one.  Put <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> at the top of the BNF
description, and save it as a file called <span class="stt">"nested-word-list.rkt"</span>.</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"nested-word-list.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">nested-word-list: WORD</span></span></p></td></tr><tr><td><p><span class="stt"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| LEFT-PAREN nested-word-list* RIGHT-PAREN</span></span></p></td></tr></table></blockquote></blockquote><p>Now it is a proper program.  But what does it do?</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"nested-word-list.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span></td></tr><tr><td><p><span class="RktRes">#&lt;procedure:parse&gt;</span></p></td></tr></table></blockquote><p>It gives us a <span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span> function.  Let&rsquo;s investigate what <span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span>
does for us.  What happens if we pass it a sequence of tokens?</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-parsed-value</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"("</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"some"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"["</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"pig"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"]"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">")"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">a-parsed-value</span></td></tr><tr><td><p><span class="RktRes">#&lt;syntax (nested-word-list "(" (nested...&gt;</span></p></td></tr></table></blockquote><p><div class="SIntrapara">Wait... that looks suspiciously like a syntax object!
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-parsed-value</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td><p><span class="RktRes">'(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "some")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "[" (nested-word-list "pig") "]")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>That&rsquo;s <span class="RktPn">(</span><span class="RktSym">some</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">pig</span><span class="RktPn">]</span><span class="RktPn">)</span>, essentially.</p><p><div class="SIntrapara">What happens if we pass it a more substantial source of tokens?
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">tokenize: string -&gt; (sequenceof token-struct?)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Generate tokens from a string:</span></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/for.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._for%2Flist))" class="RktStxLink" pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/regexp.html#(def._((lib._racket%2Fprivate%2Fbase..rkt)._regexp-match*))" class="RktValLink" pltdoc="x">regexp-match*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#px"\\(|\\)|\\w+"</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#(form._((lib._racket%2Fmatch..rkt)._match))" class="RktStxLink" pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"("</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">")"</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#(form._((lib._racket%2Fprivate%2Fletstx-scheme..rkt)._else))" class="RktStxLink" pltdoc="x">else</a></span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">For example:</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-source</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktVal">"(welcome (to (((ragg)) ())))"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-source</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td><p><span class="RktRes">'(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "welcome")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "to")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "(" (nested-word-list "ragg") ")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "(" ")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>Welcome to <span class="stt">ragg</span>.</p><h3>2<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p><div class="SIntrapara"><span class="stt">ragg</span> is a parsing framework with the design goal to be easy
to use.  It includes the following features:
</div><div class="SIntrapara"><ul><li><p>It provides a <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> for writing extended BNF grammars.
A module written in <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> automatically generates a
parser.  The output of this parser tries to follow
<a href="http://en.wikipedia.org/wiki/How_to_Design_Programs">HTDP</a>
doctrine; the structure of the grammar informs the structure of the
Racket syntax objects it generates.</p></li><li><p>The language uses a few conventions to simplify the expression of
grammars.  The first rule in the grammar is automatically assumed to be the
starting production.  Identifiers in uppercase are assumed to represent
terminal tokens, and are otherwise the names of nonterminals.</p></li><li><p>Tokenizers can be developed completely independently of parsers.
<span class="stt">ragg</span> takes a liberal view on tokens: they can be strings,
symbols, or instances constructed with <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span>.  Furthermore,
tokens can optionally provide location: if tokens provide location, the
generated syntax objects will as well.</p></li><li><p>The underlying parser should be able to handle ambiguous grammars.</p></li></ul></div></p><p>FILL ME IN: I NEED A LONG-RUNNING EXAMPLE OF A DSL HERE.  THE GOAL
IS TO SHOW HOW RAGG HELPS US TO MAKE OTHER #LANG&rsquo;S REALLY QUICKLY.</p><h3>3<tt>&nbsp;</tt><a name="(part._.The_language)"></a>The language</h3><h4>3.1<tt>&nbsp;</tt><a name="(part._.Syntax_and_terminology)"></a>Syntax and terminology</h4><p>A program in the <span class="stt">ragg</span> language consists of the language line
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span>, followed by a collection of <a href="#(tech._rule)" class="techoutside" pltdoc="x"><span class="techinside">rule</span></a>s and
<a href="#(tech._line._comment)" class="techoutside" pltdoc="x"><span class="techinside">line comment</span></a>s.</p><p>A <a name="(tech._rule)"></a><span style="font-style: italic">rule</span> is a sequence consisting of: a <a href="#(tech._rule._identifier)" class="techoutside" pltdoc="x"><span class="techinside">rule identifier</span></a>, a colon
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">":"</span><span class="hspace"></span></span>, and a <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a>.</p><p>A <a name="(tech._rule._identifier)"></a><span style="font-style: italic">rule identifier</span> is an <a href="#(tech._identifier)" class="techoutside" pltdoc="x"><span class="techinside">identifier</span></a> that is not in upper case.</p><p>A <a name="(tech._token._identifier)"></a><span style="font-style: italic">token identifier</span> is an <a href="#(tech._identifier)" class="techoutside" pltdoc="x"><span class="techinside">identifier</span></a> that is in upper case.</p><p>An <a name="(tech._identifier)"></a><span style="font-style: italic">identifier</span> is a character sequence of letters, numbers, and
characters in <span class="RktVal">"-.!$%&amp;/&lt;=&gt;?^_~@"</span>.  It must not contain
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span>, as those characters are used to denote
quantification.</p><p><div class="SIntrapara">A <a name="(tech._pattern)"></a><span style="font-style: italic">pattern</span> is one of the following:
</div><div class="SIntrapara"><ul><li><p>an implicit sequence of <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a>s separated by whitespace</p></li><li><p>a terminal: either a literal string or a <a href="#(tech._token._identifier)" class="techoutside" pltdoc="x"><span class="techinside">token identifier</span></a></p></li><li><p>a <a href="#(tech._rule._identifier)" class="techoutside" pltdoc="x"><span class="techinside">rule identifier</span></a></p></li><li><p>a <a name="(tech._choice._pattern)"></a><span style="font-style: italic">choice pattern</span>: a sequence of <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a>s delimited with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">|</span><span class="hspace"></span></span> characters.</p></li><li><p>a <a name="(tech._quantifed._pattern)"></a><span style="font-style: italic">quantifed pattern</span>: a <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a> followed by either <span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> (&ldquo;zero or more&rdquo;) or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span> (&ldquo;one or more&rdquo;)</p></li><li><p>an <a name="(tech._optional._pattern)"></a><span style="font-style: italic">optional pattern</span>: a <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a> surrounded by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">[</span><span class="hspace"></span></span> and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">]</span><span class="hspace"></span></span></p></li><li><p>an explicit sequence: a <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a> surrounded by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">(</span><span class="hspace"></span></span> and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">)</span><span class="hspace"></span></span></p></li></ul></div></p><p>A <a name="(tech._line._comment)"></a><span style="font-style: italic">line comment</span> begins with either <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">;</span><span class="hspace"></span></span> and
continues till the end of the line.</p><p><div class="SIntrapara">For example, in the following program:
</div><div class="SIntrapara"><blockquote><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">;; A parser for a silly language</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">sentence: verb optional-adjective object</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">verb: greeting</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">optional-adjective: ["happy" | "frumpy"]</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">greeting: "hello" | "hola" | "aloha"</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">object: "world" | WORLD</span></span></p></td></tr></table></blockquote></div></p><p>the elements <span class="stt">sentence</span>, <span class="stt">verb</span>, <span class="stt">greeting</span>, and <span class="stt">object</span> are rule
identifiers.  The third line, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">sentence: verb optional-adjective object</span><span class="hspace"></span></span>, is a rule whose right side is an implicit pattern sequence of three
sub-patterns.  The uppercased <span class="stt">WORLD</span> is a token identifier.  The last rule in the program associates <span class="stt">greeting</span> with a <a href="#(tech._choice._pattern)" class="techoutside" pltdoc="x"><span class="techinside">choice pattern</span></a>.</p><p><div class="SIntrapara">More examples:
</div><div class="SIntrapara"><ul><li><p><div class="SIntrapara">A
<a href="http://hashcollision.org/ragg/examples/01-equal.rkt">BNF</a> for binary
strings that contain an equal number of zeros and ones.
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt">equal: [zero one | one zero]<span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">;; equal number of "0"s and "1"s.</span></span></p></td></tr><tr><td><p><span class="stt">zero: "0" equal | equal "0"<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">;; has an extra "0" in it.</span></span></p></td></tr><tr><td><p><span class="stt">one: "1" equal | equal "1"<span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">;; has an extra "1" in it.</span></span></p></td></tr></table></div></p></li><li><p><div class="SIntrapara">A <a href="http://hashcollision.org/ragg/examples/baby-json.rkt">BNF</a> for
<a href="http://www.json.org/">JSON</a>-like structures.
</div><div class="SIntrapara"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">json: number | string</span></span></p></td></tr><tr><td><p><span class="stt"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span>| array<span class="hspace">&nbsp;&nbsp;</span><span class="stt">| object</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">number: NUMBER</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">string: STRING</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">array: "[" [json ("," json)*] "]"</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">object: "{" [kvpair ("," kvpair)*] "}"</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">kvpair: ID ":" json</span></span></p></td></tr></table></div></p></li></ul></div></p><p>The <a href="https://github.com/dyoo/ragg">ragg github source repository</a>
includes
<a href="https://github.com/dyoo/ragg/tree/master/ragg/examples">several more
examples</a>.</p><h4>3.2<tt>&nbsp;</tt><a name="(part._.Syntax_errors)"></a>Syntax errors</h4><p>Besides the basic syntax errors that can occur with a malformed grammar, there
are a few other classes of situations that <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> will consider
as syntax errors.</p><p><div class="SIntrapara"><span class="stt">ragg</span> will raise a syntax error if the grammar:
</div><div class="SIntrapara"><ul><li><p>doesn&rsquo;t have any rules.</p></li><li><p>has a rule with the same left hand side as any other rule.</p></li><li><p><div class="SIntrapara">refers to rules that have not been defined.  e.g. the
following program:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">foo: [bar]</span></span></p></td></tr></table></blockquote></div><div class="SIntrapara">should raise an error because <span class="stt">bar</span> has not been defined, even though
<span class="stt">foo</span> refers to it in an <a href="#(tech._optional._pattern)" class="techoutside" pltdoc="x"><span class="techinside">optional pattern</span></a>.</div></p></li><li><p><div class="SIntrapara">contains a rule that has no finite derivation.  e.g. the following
program:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">infinite-a: "a" infinite-a</span></span></p></td></tr></table></blockquote></div><div class="SIntrapara">should raise an error because no finite sequence of tokens will satisfy
<span class="stt">infinite-a</span>.</div></p></li></ul></div></p><p>Otherwise, <span class="stt">ragg</span> should be fairly tolerant and permit even ambiguous
grammars.</p><h4>3.3<tt>&nbsp;</tt><a name="(part._.Semantics)"></a>Semantics</h4><p>A program written in <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> produces a module that provides a few
bindings.  The most important of these is <span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span>:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._ragg/examples/nested-word-list..rkt)._parse))"></a><span title="Provided from: ragg/examples/nested-word-list"><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span></span><span class="hspace">&nbsp;</span>[<span class="RktVar">source</span>]<span class="hspace">&nbsp;</span><span class="RktVar">token-source</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax~3f))" class="RktValLink" pltdoc="x">syntax?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">source</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">token-source</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/sequences.html#(def._((lib._racket%2Fprivate%2Fbase..rkt)._sequence~3f))" class="RktValLink" pltdoc="x">sequence?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Parses the sequence of tokens according to the rules in the grammar, using the
first rule as the start production.  The parse must completely consume
<span class="RktVar">token-source</span>.  See <a href="#(part._token-sources)" pltdoc="x">Token sources</a> for more details on what
kind of values are considered to be tokens.</div></p><p>If it succeeds, <span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span> will return a syntax object.
The structure of the syntax object follows the overall structure of the rules in
the BNF.  For each rule <span class="RktSym">r</span> and its associated pattern <span class="RktSym">p</span>,
<span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span> generates a syntax object <span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="stt"> </span><span class="RktSym">p-value</span><span class="RktPn">)</span> where
<span class="RktSym">p-value</span>&rsquo;s structure follows a case analysis on <span class="RktSym">p</span>:</p><ul><li><p>For implicit and explicit sequences of <a href="#(tech._pattern)" class="techoutside" pltdoc="x"><span class="techinside">pattern</span></a>s <span class="RktSym">p1</span>,
<span class="RktSym">p2</span>, ..., the corresponding values, spliced into the
structure.</p></li><li><p>For terminals, the value associated to the token.</p></li><li><p>For <a href="#(tech._rule._identifier)" class="techoutside" pltdoc="x"><span class="techinside">rule identifier</span></a>s: the associated parse value for the rule.</p></li><li><p>For <a href="#(tech._choice._pattern)" class="techoutside" pltdoc="x"><span class="techinside">choice pattern</span></a>s: the associated parse value for one of the matching subpatterns.</p></li><li><p>For <a href="#(tech._quantifed._pattern)" class="techoutside" pltdoc="x"><span class="techinside">quantifed pattern</span></a>s and <a href="#(tech._optional._pattern)" class="techoutside" pltdoc="x"><span class="techinside">optional pattern</span></a>s: the corresponding values, spliced into the structure.</p></li></ul><p>Consequently, it&rsquo;s only the presence of <a href="#(tech._rule._identifier)" class="techoutside" pltdoc="x"><span class="techinside">rule identifier</span></a>s in a rule&rsquo;s
pattern that informs the parser to introduces nested structure into the syntax
object.</p><p>If the parse cannot be performed successfully, an instance of <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing))" class="RktValLink" pltdoc="x">exn:fail:parsing</a></span> is raised.</p><p>It&rsquo;s often convenient to extract a parser for other non-terminal rules in the
grammar, and not just for the first rule.  A <span class="stt">ragg</span>-generated module also
provides a form called <span class="RktSym"><a href="#(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))" class="RktStxLink" pltdoc="x">make-rule-parser</a></span> to extract a parser for the
other non-terminals:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))"></a><span title="Provided from: ragg/examples/nested-word-list"><span class="RktSym"><a href="#(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))" class="RktStxLink" pltdoc="x">make-rule-parser</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a parser for the <span class="RktVar">name</span> of one of the non-terminals
in the grammar.</div></p><p><div class="SIntrapara">For example, given the <span class="stt">ragg</span> program
<span class="stt">"simple-arithmetic-grammar.rkt"</span>:
</div><div class="SIntrapara"><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"simple-arithmetic-grammar.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">#lang ragg</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">expr : term ('+' term)*</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">term : factor ('*' factor)*</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">factor : INT</span></span></p></td></tr></table></blockquote></blockquote></div><div class="SIntrapara">the following interaction shows how to extract a parser for <span class="RktSym">term</span>s.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"simple-arithmetic-grammar.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))" class="RktStxLink" pltdoc="x">make-rule-parser</a></span><span class="hspace">&nbsp;</span><span class="RktSym">term</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"*"</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(expr (term (factor 3) "*" (factor 4)))</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(term (factor 3) "*" (factor 4))</span></p></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"+"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"*"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._ragg/examples/nested-word-list..rkt)._parse))" class="RktValLink" pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(expr (term (factor 1)) "+" (term (factor 2) "*" (factor 3)))</span></p></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Note that term-parse will break on another-token-sequence</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">as it does not know what to do with the "+"</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktErr">Encountered parsing error near token '+ ("+") while parsing</span></p></td></tr><tr><td><p><span class="RktErr">#f [line=#f, column=#f, offset=#f]</span></p></td></tr></table></blockquote></div></p><h4>3.4<tt>&nbsp;</tt><a name="(part._token-sources)"></a>Token sources</h4><p>FILL ME IN PLEASE</p><h3>4<tt>&nbsp;</tt><a name="(part._.Support_.A.P.I)"></a><a name="(mod-path._ragg/support)"></a>Support API</h3><p><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._ragg/support)" class="RktModLink" pltdoc="x"><span class="RktSym">ragg/support</span></a><span class="RktPn">)</span></td></tr></table></p><p>The <a href="#(mod-path._ragg/support)" class="RktModLink" pltdoc="x"><span class="RktSym">ragg/support</span></a> module provides functions to interact with
<span class="stt">ragg</span> programs.  The most useful is the <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span> function, which
produces tokens to be parsed.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((lib._ragg/support..rkt)._token))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">type</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span>[</td><td><span class="RktVar">val</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:line</span><span class="hspace">&nbsp;</span><span class="RktVar">line</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:column</span><span class="hspace">&nbsp;</span><span class="RktVar">column</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:offset</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:span</span><span class="hspace">&nbsp;</span><span class="RktVar">span</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:whitespace?</span><span class="hspace">&nbsp;</span><span class="RktVar">whitespace</span>]<span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token-struct~3f))" class="RktValLink" pltdoc="x">token-struct?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._symbol~3f))" class="RktValLink" pltdoc="x">symbol?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">val</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">line</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">column</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">span</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">whitespace</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates instances of <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token-struct))" class="RktValLink" pltdoc="x">token-struct</a></span>s.</div></p><p>The syntax objects produced by a parse will inject the value <span class="RktVar">val</span> in
place of the token name in the grammar.</p><p>If <span class="RktPn">#:whitespace?</span> is true, then the parser will skip over it during a
parse.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" class="RForeground"><colgroup><col width="0*" /><col width="0*" /><col width="0*" /><col width="0*" /><col /></colgroup><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._ragg/support..rkt)._token-struct-whitespace~3f))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-span))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-column))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-line))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-offset))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-val))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-type))"></a><a name="(def._((lib._ragg/support..rkt)._make-token-struct))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct~3f))"></a><a name="(def._((lib._ragg/support..rkt)._struct~3atoken-struct))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token-struct))" class="RktValLink" pltdoc="x">token-struct</a></span></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">type</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">val</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">offset</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">line</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">column</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">span</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">whitespace?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-token-struct</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#(def._((quote._~23~25kernel)._symbol~3f))" class="RktValLink" pltdoc="x">symbol?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">column</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">span</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._or%2Fc))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">whitespace?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The token structure type.</div></p><p>Rather than directly using the <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token-struct))" class="RktValLink" pltdoc="x">token-struct</a></span> constructor, please use
the helper function <span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._token))" class="RktValLink" pltdoc="x">token</a></span> to construct instances.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" class="RForeground"><colgroup><col width="0*" /><col width="0*" /><col width="0*" /><col width="0*" /><col /></colgroup><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define-struct.html#(form._((lib._racket%2Fprivate%2Fbase..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-srclocs))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-continuation-marks))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-message))"></a><a name="(def._((lib._ragg/support..rkt)._make-exn~3afail~3aparsing))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing~3f))"></a><a name="(def._((lib._ragg/support..rkt)._struct~3aexn~3afail~3aparsing))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing))" class="RktValLink" pltdoc="x">exn:fail:parsing</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((lib._racket%2Fprivate%2Fbase..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">message</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">continuation-marks</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">srclocs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-exn:fail:parsing</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">message</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">continuation-marks</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/contmarks.html#(def._((quote._~23~25kernel)._continuation-mark-set~3f))" class="RktValLink" pltdoc="x">continuation-mark-set?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">srclocs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._listof))" class="RktValLink" pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#(def._((quote._~23~25kernel)._srcloc~3f))" class="RktValLink" pltdoc="x">srcloc?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The exception raised when parsing fails.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._ragg/support..rkt)._current-source))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._current-source))" class="RktValLink" pltdoc="x">current-source</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">parameterof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">blah blah</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._ragg/support..rkt)._current-parser-error-handler))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._current-parser-error-handler))" class="RktValLink" pltdoc="x">current-parser-error-handler</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">parameterof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">blah blah blah</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._ragg/support..rkt)._current-tokenizer-error-handler))"></a><span title="Provided from: ragg/support"><span class="RktSym"><a href="#(def._((lib._ragg/support..rkt)._current-tokenizer-error-handler))" class="RktValLink" pltdoc="x">current-tokenizer-error-handler</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">parameterof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#(def._((lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt)._any%2Fc))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">blah!</div></p><h3>5<tt>&nbsp;</tt><a name="(part._.Bugs_and_caveats_and_.T.O.D.Os)"></a>Bugs and caveats and TODOs</h3><p>[Missing test for grammars with undefined rules.]</p><p>[Missing test for grammars with repeated rules.]</p><p>[Missing explanation for ambiguous parses]</p><p>[Handle specials with distinguished SPECIAL token name]</p><p>[Larger, more comprehensive test suite]</p><p>[Missing convenient syntax for simple lexers]</p><p>[Symbols can be tokens?]</p><p>[Strings can be tokens?]</p><h3>6<tt>&nbsp;</tt><a name="(part._.Miscellaneous_and_thanks)"></a>Miscellaneous and thanks</h3><p>Thanks to Joe Politz for advice and feedback.  Also, he suggested the name
&ldquo;ragg&rdquo;.  Other alternatives I&rsquo;d been considering were
&ldquo;autogrammar&rdquo; or &ldquo;chompy&rdquo;.  Thankfully, he is a better Namer than me.
Daniel Patterson provided feedback that led to <span class="RktSym"><a href="#(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))" class="RktStxLink" pltdoc="x">make-rule-parser</a></span>.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>